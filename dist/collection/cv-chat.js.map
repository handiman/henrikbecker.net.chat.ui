{"version":3,"file":"cv-chat.js","sourceRoot":"","sources":["../src/cv-chat.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Prop, h, State, Element } from '@stencil/core';\r\nimport { marked } from 'marked';\r\n\r\n@Component({\r\n  tag: 'cv-chat',\r\n  styleUrl: 'cv-chat.css',\r\n  shadow: true\r\n})\r\nexport class CvChat {\r\n  @Prop() collection: string = '';\r\n  @Prop() placeholder: string = 'Ask my CV bot anything...'\r\n  @Prop() error: string = 'Something went wrong while contacting my brain.'\r\n  @State() question: string = '';\r\n  @State() answer: string = '';\r\n  @State() chunks: string[] = [];\r\n  @State() loading: boolean = false;\r\n  @State() minimized: boolean = false;\r\n\r\n  async handleAsk() {\r\n    if (!this.question.trim()) return;\r\n\r\n    this.loading = true;\r\n    this.answer = '';\r\n    this.chunks = [];\r\n\r\n    try {\r\n      const response = await fetch('https://henrikbecker.azurewebsites.net/ai/ask/' + this.collection, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(this.question)\r\n      });\r\n\r\n      const data = await response.json();\r\n      this.answer = await marked(data.answer);\r\n      this.chunks = data.chunks;\r\n\r\n      this.logDebug(this.question, data);\r\n    } catch (error) {\r\n      this.answer = error + \" \" + this.error;\r\n    }\r\n\r\n    this.minimized = false;\r\n    this.loading = false;\r\n  }\r\n\r\n  private logDebug(question: string, data: any) {\r\n    console.groupCollapsed(`ðŸ’¬ ${question}`);\r\n    console.log('ðŸ§  Original Question:', question);\r\n    console.log('ðŸ“š Chunks:', data.chunks);\r\n    console.groupEnd();\r\n  }\r\n\r\n  private handleKeyDown(e: KeyboardEvent) {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      this.handleAsk();\r\n    }\r\n  }\r\n  \r\n  toggleMinimize() {\r\n    this.minimized = !this.minimized;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div part=\"container\">\r\n        <div class=\"input-wrapper\">\r\n          <input\r\n            id=\"question\"\r\n            part=\"input\"\r\n            type=\"text\"\r\n            value={this.question}\r\n            onInput={e => this.question = (e.target as HTMLInputElement).value}\r\n            onKeyDown={e => this.handleKeyDown(e)}\r\n            placeholder={this.placeholder}\r\n          />\r\n          <button\r\n            part=\"icon-button\"\r\n            class=\"ask-button\"\r\n            onClick={() => this.handleAsk()}\r\n            disabled={this.loading}\r\n            title=\"Ask\"\r\n          >\r\n            {this.loading ? (\r\n                <img src=\"/favicon.ico\" class=\"spinner\" />\r\n              ) : (\r\n                <img src=\"/favicon.ico\" />\r\n              )}\r\n          </button>\r\n        </div>\r\n\r\n        {!this.minimized && this.answer && (\r\n          <div part=\"response\" class=\"response-box\">\r\n            <p innerHTML={this.answer}></p>\r\n            <button class=\"close-button\" onClick={() => this.minimized = true} title=\"StÃ¤ng\">\r\n              &times;\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}"]}