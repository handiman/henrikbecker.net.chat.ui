{"version":3,"file":"cv-chat.entry.cjs.js","sources":["src/cv-chat.css?tag=cv-chat&encapsulation=shadow","src/cv-chat.tsx"],"sourcesContent":[":host {\r\n  display: block;\r\n  position: relative;\r\n  font-family: system-ui, sans-serif;\r\n  z-index: 1000;\r\n\r\n  /* Temavariabler */\r\n  --chat-bg: #ffffff;\r\n  --chat-text: #333333;\r\n  --chat-accent: #26a69a;\r\n  --chat-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\r\n  --chat-radius: 6px;\r\n\r\n  --confidence-high-bg: #e0f8e9;\r\n  --confidence-high-text: #2e7d32;\r\n  --confidence-medium-bg: #fff8e1;\r\n  --confidence-medium-text: #f9a825;\r\n  --confidence-low-bg: #ffebee;\r\n  --confidence-low-text: #c62828;\r\n}\r\n\r\n/* InputfÃ¤lt + knapp */\r\n.input-wrapper {\r\n  position: relative;\r\n  display: flex;\r\n  align-items: center;\r\n  background: var(--chat-bg);\r\n  border-radius: var(--chat-radius);\r\n  padding: 0.3rem 0.5rem;\r\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\r\n  min-width: 240px;\r\n}\r\n\r\ninput[part=\"input\"] {\r\n  flex: 1;\r\n  border: none;\r\n  outline: none;\r\n  font-size: 0.9rem;\r\n  padding: 0.4rem;\r\n  background: transparent;\r\n  color: var(--chat-text);\r\n}\r\n\r\n.ask-button {\r\n  background: none;\r\n  border: none;\r\n  cursor: pointer;\r\n  padding: 0.3rem;\r\n}\r\n\r\n.ask-button img {\r\n  width: 20px;\r\n  height: 20px;\r\n}\r\n\r\n.spinner {\r\n  animation: spin 1s linear infinite;\r\n}\r\n\r\n@keyframes spin {\r\n  0% { transform: rotate(0deg); }\r\n  100% { transform: rotate(360deg); }\r\n}\r\n\r\n/* Svarspanel */\r\n.response-box {\r\n  position: absolute;\r\n  top: calc(100% + 4px); /* direkt under input-wrapper */\r\n  left: 0;\r\n  background: var(--chat-bg);\r\n  box-shadow: var(--chat-shadow);\r\n  border-radius: var(--chat-radius);\r\n  padding: 1rem 1rem 2.5rem 1rem; /* extra bottenutrymme fÃ¶r knappar */\r\n  min-width: 280px;\r\n  max-width: 400px;\r\n  z-index: 9999;\r\n  font-size: 0.85rem;\r\n  color: var(--chat-text);\r\n}\r\n\r\n.response-box p {\r\n  margin: 0 0 0.5rem 0;\r\n}\r\n\r\n/* Confidence i nedre vÃ¤nstra hÃ¶rnet */\r\n.confidence {\r\n  position: absolute;\r\n  bottom: 8px;\r\n  left: 12px;\r\n  font-size: 0.75rem;\r\n  font-weight: bold;\r\n  text-transform: uppercase;\r\n  padding: 0.2rem 0.4rem;\r\n  border-radius: 4px;\r\n}\r\n\r\n.confidence.high {\r\n  background: var(--confidence-high-bg);\r\n  color: var(--confidence-high-text);\r\n}\r\n\r\n.confidence.medium {\r\n  background: var(--confidence-medium-bg);\r\n  color: var(--confidence-medium-text);\r\n}\r\n\r\n.confidence.low {\r\n  background: var(--confidence-low-bg);\r\n  color: var(--confidence-low-text);\r\n}\r\n\r\n/* StÃ¤ng-knapp i nedre hÃ¶gra hÃ¶rnet */\r\n.close-button {\r\n  position: absolute;\r\n  bottom: 8px;\r\n  right: 12px;\r\n  background: none;\r\n  border: none;\r\n  font-size: 1.2rem;\r\n  color: #888;\r\n  cursor: pointer;\r\n  line-height: 1;\r\n}\r\n\r\n/* Responsiv justering */\r\n@media (max-width: 600px) {\r\n  .input-wrapper {\r\n    min-width: 100%;\r\n  }\r\n\r\n  .response-box {\r\n    max-width: 100%;\r\n    left: 0;\r\n    right: auto;\r\n  }\r\n}\r\n\r\nbutton img {\r\n  width: 16px;\r\n  height: 16px;\r\n}","import { Component, Prop, h, State, Element } from '@stencil/core';\r\n\r\n@Component({\r\n  tag: 'cv-chat',\r\n  styleUrl: 'cv-chat.css',\r\n  shadow: true\r\n})\r\nexport class CvChat {\r\n  @Prop() collection: string = '';\r\n  @Prop() placeholder: string = 'Ask my CV bot anything...'\r\n  @Prop() error: string = 'Something went wrong while contacting my brain.'\r\n  @State() question: string = '';\r\n  @State() answer: string = '';\r\n  @State() confidence: string = '';\r\n  @State() promptGuard: string = '';\r\n  @State() chunks: string[] = [];\r\n  @State() loading: boolean = false;\r\n  @State() minimized: boolean = false;\r\n  @Element() el: HTMLElement;\r\n\r\n  componentDidLoad() {\r\n    document.addEventListener('click', this.handleClickOutside);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    document.removeEventListener('click', this.handleClickOutside);\r\n  }\r\n\r\n  private handleClickOutside = (event: MouseEvent) => {\r\n    const host = this.el.shadowRoot || this.el;\r\n    if (!host.contains(event.target as Node)) {\r\n      this.minimized = true;\r\n    }\r\n  };\r\n\r\n  constructor() {\r\n    this.el = document.createElement('div');\r\n  }\r\n\r\n  async handleAsk() {\r\n    if (!this.question.trim()) return;\r\n\r\n    this.loading = true;\r\n    this.answer = '';\r\n    this.confidence = '';\r\n    this.promptGuard = '';\r\n    this.chunks = [];\r\n\r\n    try {\r\n      const response = await fetch('https://henrikbecker.azurewebsites.net/ai/ask/' + this.collection, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(this.question)\r\n      });\r\n\r\n      const data = await response.json();\r\n      this.answer = data.answer;\r\n      this.confidence = data.confidence;\r\n      this.promptGuard = data.promptGuard;\r\n      this.chunks = data.chunks;\r\n\r\n      this.logDebug(this.question, data);\r\n    } catch (error) {\r\n      this.answer = error + \" \" + this.error;\r\n    }\r\n\r\n    this.minimized = false;\r\n    this.loading = false;\r\n  }\r\n\r\n  private logDebug(question: string, data: any) {\r\n    console.groupCollapsed(`ðŸ’¬ ${question}`);\r\n    console.log('ðŸ§© PromptGuard:', data.promptGuard);\r\n    console.log('ðŸ“š Chunks:', data.chunks);\r\n    console.log('ðŸŽ¯ Confidence:', data.confidence);\r\n    console.log('ðŸ§  Response Type:', this.extractResponseType(data.answer));\r\n    console.log('ðŸ§  Original Question:', question);\r\n    console.groupEnd();\r\n  }\r\n\r\n  private extractResponseType(answer: string): string {\r\n    if (answer.includes('Faktabaserat')) return 'Faktabaserat';\r\n    if (answer.includes('Tolkning')) return 'Tolkning';\r\n    if (answer.includes('Kreativ')) return 'Kreativ extrapolering';\r\n    return 'OkÃ¤nt';\r\n  }\r\n\r\n  private handleKeyDown(e: KeyboardEvent) {\r\n    if (e.key === 'Enter') {\r\n      e.preventDefault();\r\n      this.handleAsk();\r\n    }\r\n  }\r\n  \r\n  toggleMinimize() {\r\n    this.minimized = !this.minimized;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div part=\"container\">\r\n        <div class=\"input-wrapper\">\r\n          <input\r\n            id=\"question\"\r\n            part=\"input\"\r\n            type=\"text\"\r\n            value={this.question}\r\n            onInput={e => this.question = (e.target as HTMLInputElement).value}\r\n            onKeyDown={e => this.handleKeyDown(e)}\r\n            placeholder={this.placeholder}\r\n          />\r\n          <button\r\n            part=\"icon-button\"\r\n            class=\"ask-button\"\r\n            onClick={() => this.handleAsk()}\r\n            disabled={this.loading}\r\n            title=\"Ask\"\r\n          >\r\n            {this.loading ? (\r\n                <img src=\"/favicon.ico\" class=\"spinner\" />\r\n              ) : (\r\n                <img src=\"/favicon.ico\" />\r\n              )}\r\n          </button>\r\n        </div>\r\n\r\n        {!this.minimized && this.answer && (\r\n          <div part=\"response\" class=\"response-box\">\r\n            <p>{this.answer}</p>\r\n            <span part=\"confidence\" class={`confidence ${this.confidence.toLowerCase()}`}>\r\n              {this.confidence}\r\n            </span>\r\n            <button class=\"close-button\" onClick={() => this.minimized = true} title=\"StÃ¤ng\">\r\n              &times;\r\n            </button>\r\n          </div>\r\n        )}\r\n      </div>\r\n    );\r\n  }\r\n}"],"names":["h"],"mappings":"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"}